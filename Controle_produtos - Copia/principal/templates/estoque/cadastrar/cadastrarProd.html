{% extends 'base.html' %}

{% block content %}
<main role="main" class="ml-sm-auto px-4" id="content">
    <div class="row d-flex justify-content-center">
        <form action="{% url 'salvarProd' %}" method="post">
            <h1>Cadastrar Produto</h1>
            <br>
            {% csrf_token %}
            <label>Nome</label>
            <input type="text" name="nome" class="form-control" required>
            <br><br>
            <label for="exampleFormControlSelect1">Grupo - <a href="{% url 'cadastrarGrp' %}">Cadastrar Grupo</a></label>
            <select class="form-control" id="exampleFormControlSelect1" name="grupo" required>
                <option value="" disabled selected>Selecione um grupo</option>
                {% for item in grupos %}
                <option value="{{ item.nome }}">{{ item.nome }}</option>
                {% endfor %}
            </select>
            <br><br>
            <label>Preço</label>
            <input type="text" name="preco" class="form-control">
            <br><br>
            <button type="submit" class="btn btn-dark btn-block custom-hover">Salvar</button>
        </form>
    </div>
</main>

<!-- Modal for Error -->
<div class="modal fade" id="erroModal" tabindex="-1" role="dialog" aria-labelledby="erroModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="erroModalLabel">Erro</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Você deve selecionar um grupo antes de enviar o formulário.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-dark btn-block custom-hover" data-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Aviso -->
<div class="modal fade" id="avisoModal" tabindex="-1" role="dialog" aria-labelledby="avisoModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="avisoModalLabel">Aviso</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Essas características já pertencem a outro produto.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-dark btn-block custom-hover" data-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for Aviso Cad -->
<div class="modal fade" id="avisoCadModal" tabindex="-1" role="dialog" aria-labelledby="avisoCadModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="avisoCadModalLabel">Aviso de Cadastro</h5>
                
            </div>
            <div class="modal-body">
                Produto Cadastrado Com Sucesso.
            </div>
            
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Inicializa o sidebar como colapsado e o conteúdo expandido
        document.getElementById('sidebar').classList.add('collapsed');
        document.getElementById('content').classList.add('expanded');

        // Evento para alternar o estado do sidebar ao clicar no botão
        document.getElementById('sidebarToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('collapsed');
            document.getElementById('content').classList.toggle('expanded');
        });

        // Gerenciamento dos dropdowns
        document.querySelectorAll('#sidebar .dropdown-toggle').forEach(function(toggle) {
            toggle.addEventListener('click', function(event) {
                event.preventDefault();
                const menu = this.nextElementSibling;
                const isVisible = menu.classList.contains('show');

                // Esconder todos os dropdowns
                document.querySelectorAll('#sidebar .dropdown-menu').forEach(function(dropdown) {
                    dropdown.classList.remove('show');
                });

                // Mostrar o dropdown clicado
                if (!isVisible) {
                    menu.classList.add('show');
                }
            });
        });
    });

    // Verifica se a variável 'aviso' está definida e é verdadeira
    {% if aviso %}
        $(document).ready(function() {
            $('#avisoModal').modal('show');
        });
    {% endif %}

   // Verifica se a variável 'aviso_cad' está definida e é verdadeira
{% if aviso_cad %}
    $(document).ready(function() {
        $('#avisoCadModal').modal('show');
        setTimeout(function() {
            $('#avisoCadModal').fadeOut(50, function() {
                $(this).modal('hide');
            });
        }, 1000); // 1000 milissegundos = 1 segundo
    });
{% endif %}

</script>

{% endblock %}
