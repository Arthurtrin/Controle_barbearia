{% extends 'base_age.html' %}

{% block content %}
<main role="main" class="ml-sm-auto px-4" id="content">
    <!-- Título Centralizado Acima dos Cards -->
    <div class="text-center mb-4">
        <h1>Agendar</h1>
    </div>

    <div class="row justify-content-center">
        {% for corte in cortes %}
        <div class="col-6 col-md-3 d-flex align-items-stretch mb-4">
            <div class="card w-100 h-100">
                <div class="card-body d-flex flex-column">
                    <h6 class="card-title">{{ corte.nome }}</h6>
                    <p class="card-text">Tempo: {{ corte.tempo|date:"H:i:s" }} </p>
                    <a href="{% url 'ir_teste' corte.id %}" class="btn horario-btn mt-auto">R$ {{ corte.preco }}</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    
</main>

<!-- Modal de Aviso -->
<div class="modal fade" id="avisoModal" tabindex="-1" role="dialog" aria-labelledby="avisoModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="avisoModalLabel">Aviso</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                {{msg}}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Horário -->
<div class="modal fade" id="horarioModal" tabindex="-1" role="dialog" aria-labelledby="horarioModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="horarioModalLabel">Horários Disponíveis:</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="horariosDisponiveis" class="d-flex flex-wrap justify-content-center">
                    <!-- Horários como links -->
                    {% for horario in horarios %}
                    <a href="{% url 'marcar_conf' dia_semana dia mes ano tempo horario %}" class="btn horario-btn flex-grow-1 m-1">
                        {{ horario }}
                    </a>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Scripts e JavaScript -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Código existente para a sidebar e modais
        document.getElementById('sidebar').classList.add('collapsed');
        document.getElementById('content').classList.add('expanded');

        document.getElementById('sidebarToggle').addEventListener('click', function() {
            document.getElementById('sidebar').classList.toggle('collapsed');
            document.getElementById('content').classList.toggle('expanded');
        });

        document.querySelectorAll('#sidebar .dropdown-toggle').forEach(function(toggle) {
            toggle.addEventListener('click', function(event) {
                event.preventDefault();
                const menu = this.nextElementSibling;
                const isVisible = menu.classList.contains('show');

                document.querySelectorAll('#sidebar .dropdown-menu').forEach(function(dropdown) {
                    dropdown.classList.remove('show');
                });

                if (!isVisible) {
                    menu.classList.add('show');
                }
            });
        });

        {% if aviso %}
            $(document).ready(function() {
                $('#avisoModal').modal('show');
            });
        {% endif %}

        $(document).ready(function() {
            $('#avisoCadModal').modal('show');
            setTimeout(function() {
                $('#avisoCadModal').fadeOut(50, function() {
                    $(this).modal('hide');
                });
            }, 1000);
        });

        {% if hor %}
            $(document).ready(function() {
                $('#horarioModal').modal('show');
            });
        {% endif %}
    });
</script>

<style>
    /* Estilo personalizado para os botões */
.horario-btn {
    color: #343a40;
    border-color: #343a40;
    text-align: center;
    transition: background-color 0.3s, color 0.3s;
    flex: 1 0 calc(33.333% - 10px); /* Responsivo: três botões por linha */
    max-width: calc(33.333% - 10px); /* Limita o tamanho para garantir alinhamento */
    min-width: 100px; /* Garante que não fiquem muito pequenos */
}

/* Efeito hover */
.horario-btn:hover {
    background-color: #343a40;
    color: white;
    border-color: #343a40;
}

/* Ajustes para telas pequenas */
@media (max-width: 576px) {
    .horario-btn {
        flex: 1 0 calc(50% - 10px); /* Dois botões por linha em telas pequenas */
        max-width: calc(50% - 10px);
    }
}

/* Ajustes para telas muito pequenas */
@media (max-width: 360px) {
    .horario-btn {
        flex: 1 0 100%; /* Um botão por linha em telas menores */
        max-width: 100%;
    }
}

/* Estilo personalizado para os botões */
.horario-btn {
    color: #343a40;
    border-color: #343a40;
    text-align: center;
    transition: background-color 0.3s, color 0.3s;
}

/* Efeito hover */
.horario-btn:hover {
    background-color: #343a40;
    color: white;
    border-color: #343a40;
}


</style>
{% endblock %}
